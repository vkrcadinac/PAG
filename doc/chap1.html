<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>GAP (PAG) - Chapter 1: The PAG Package</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="GAPDoc2HTML" />
<link rel="stylesheet" type="text/css" href="manual.css" />
<script src="manual.js" type="text/javascript"></script>
<script type="text/javascript">overwriteStyle();</script>
</head>
<body class="chap1"  onload="jscontent()">


<div class="chlinktop"><span class="chlink1">Goto Chapter: </span><a href="chap0.html">Top</a>  <a href="chap1.html">1</a>  <a href="chap2.html">2</a>  <a href="chapBib.html">Bib</a>  <a href="chapInd.html">Ind</a>  </div>

<div class="chlinkprevnexttop">&nbsp;<a href="chap0.html">[Top of Book]</a>&nbsp;  <a href="chap0.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap0.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap2.html">[Next Chapter]</a>&nbsp;  </div>

<p id="mathjaxlink" class="pcenter"><a href="chap1_mj.html">[MathJax on]</a></p>
<p><a id="X84BC1F5D7BD3CF55" name="X84BC1F5D7BD3CF55"></a></p>
<div class="ChapSects"><a href="chap1.html#X84BC1F5D7BD3CF55">1 <span class="Heading">The PAG Package</span></a>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap1.html#X7B1863E17896BCE1">1.1 <span class="Heading">Getting Started</span></a>
</span>
</div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap1.html#X8360C04082558A12">1.2 <span class="Heading">Installation</span></a>
</span>
</div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap1.html#X87AF9F4C789605D1">1.3 <span class="Heading">Examples: Designs</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap1.html#X85DE43FE83E85401">1.3-1 <span class="Heading">6-(14,7,4) Designs</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap1.html#X7835113382A11FA1">1.3-2 <span class="Heading">6-(28,8,<span class="SimpleMath">λ</span>) Designs</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap1.html#X82F01F238596D36C">1.3-3 <span class="Heading">2-(81,6,2) Designs</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap1.html#X7C9ADE74821A9A39">1.3-4 <span class="Heading">Quasi-symmetric 2-(56,16,18) Designs</span></a>
</span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap1.html#X7CCA2066781B6D56">1.4 <span class="Heading">Examples: Latin Squares</span></a>
</span>
</div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap1.html#X7B532D6B81CC1FC2">1.5 <span class="Heading">Examples: Cubes of Symmetric Designs</span></a>
</span>
</div>
</div>

<h3>1 <span class="Heading">The PAG Package</span></h3>

<p><em>Prescribed Automorphism Groups</em> (<strong class="pkg">PAG</strong>) is a <strong class="pkg">GAP</strong> package for constructing combinatorial objects with prescribed automorphism groups.</p>

<p><a id="X7B1863E17896BCE1" name="X7B1863E17896BCE1"></a></p>

<h4>1.1 <span class="Heading">Getting Started</span></h4>

<p>The package is loaded by</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">LoadPackage("PAG"); </span></pre></div>

<p>Let us present a small example from the paper <a href="chapBib.html#biBVK18">[Krc18]</a>. In Theorem 8.1, a simple 5-(16,7,10) design with the following automorphism group was constructed.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Group((2,3,4)(5,6,7,8,9,10)(11,12,13,14,15,16), </span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">(1,5)(2,12)(3,15)(4,8)(6,14)(7,16)(9,10)(11,13));</span></pre></div>

<p>The design can be obtained by typing</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">KramerMesnerSearch(5,16,7,10,g);</span>
Computing t-subset orbit representatives...
28
Computing k-subset orbit representatives...
71
Computing the Kramer-Mesner matrix...
[ 29, 72 ]
Starting solver...
No BOUNDS 
The RHS is fixed !
No upper bounds: 0/1 variables are assumed 

Orthogonal defect: 26.953339
First reduction successful
Orthogonal defect: 20.216092
Second reduction successful
.
.
.
</pre></div>

<p>Comments during the calculation can be supressed by setting global options.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PAGGlobalOptions.Silent:=true;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=KramerMesnerSearch(5,16,7,10,g);</span>
[ rec( autSubgroup := Group([ (2,3,4)(5,6,7,8,9,10)(11,12,13,14,15,16), 
          (1,5)(2,12)(3,15)(4,8)(6,14)(7,16)(9,10)(11,13) ]), 
      blocks := [ [ 1, 2, 3, 4, 5, 6, 13 ], [ 1, 2, 3, 4, 5, 6, 14 ], 
          [ 1, 2, 3, 4, 5, 7, 9 ], [ 1, 2, 3, 4, 5, 7, 12 ], 
          [ 1, 2, 3, 4, 5, 9, 16 ], [ 1, 2, 3, 4, 5, 10, 12 ], 
          [ 1, 2, 3, 4, 5, 10, 13 ], [ 1, 2, 3, 4, 5, 11, 12 ], 
          [ 1, 2, 3, 4, 5, 11, 16 ], [ 1, 2, 3, 4, 5, 12, 14 ], 
          [ 1, 2, 3, 4, 6, 7, 14 ], [ 1, 2, 3, 4, 6, 7, 15 ], 
.
.
.
</pre></div>

<p>The output is a list of non-isomorphic designs in the <strong class="pkg">Design</strong> package format <a href="/opt/gap-4.11.1/pkg/design-1.7/htm/CHAP001.htm"><span class="RefLink">DESIGN: Design</span></a>. We can check that it is really a 5-design.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(d,AllTDesignLambdas);</span>
[ [ 2080, 910, 364, 130, 40, 10 ] ]
</pre></div>

<p>The output is large because the <strong class="pkg">Design</strong> format includes a list of all blocks, and 5-(16,7,10) designs have 2080 blocks. Instead, we can ask just for the base blocks.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">bb:=KramerMesnerSearch(5,16,7,10,g,rec(BaseBlocks:=true));</span>
[ [ [ 1, 2, 3, 4, 5, 6, 13 ], [ 1, 2, 3, 4, 5, 6, 14 ], 
      [ 1, 2, 3, 5, 6, 7, 11 ], [ 1, 2, 3, 5, 6, 8, 9 ], 
      [ 1, 2, 3, 5, 6, 9, 10 ], [ 1, 2, 3, 5, 6, 9, 12 ], 
      [ 1, 2, 3, 5, 6, 10, 15 ], [ 1, 2, 3, 5, 6, 14, 16 ], 
      [ 1, 2, 3, 5, 8, 11, 12 ], [ 1, 2, 5, 6, 7, 8, 16 ], 
      [ 1, 2, 5, 6, 7, 9, 14 ], [ 1, 2, 5, 6, 7, 12, 13 ], 
      [ 1, 2, 5, 6, 7, 14, 15 ] ], 
  [ [ 1, 2, 3, 4, 5, 6, 8 ], [ 1, 2, 3, 4, 5, 6, 14 ], 
      [ 1, 2, 3, 5, 6, 7, 11 ], [ 1, 2, 3, 5, 6, 9, 12 ], 
      [ 1, 2, 3, 5, 6, 10, 12 ], [ 1, 2, 3, 5, 6, 10, 16 ], 
      [ 1, 2, 3, 5, 6, 12, 13 ], [ 1, 2, 3, 5, 6, 14, 15 ], 
      [ 1, 2, 3, 5, 8, 11, 12 ], [ 1, 2, 5, 6, 7, 8, 9 ], 
      [ 1, 2, 5, 6, 7, 9, 14 ], [ 1, 2, 5, 6, 7, 12, 13 ], 
      [ 1, 2, 5, 6, 11, 14, 16 ] ] ]
</pre></div>

<p>In this case isomorph rejection is not performed and we get two sets of base blocks. They can be turned into designs by calling the <code class="func">BlockDesign</code> (<a href="/opt/gap-4.11.1/pkg/design-1.7/htm/CHAP003.htm#SECT001"><span class="RefLink">DESIGN: BlockDesign</span></a>) function: <code class="code">List(bb,x-&gt;BlockDesign(16,x,g));</code>.</p>

<p><a id="X8360C04082558A12" name="X8360C04082558A12"></a></p>

<h4>1.2 <span class="Heading">Installation</span></h4>

<p>The <strong class="pkg">PAG</strong> package requires <strong class="pkg">GAP</strong> 4.11 and the following packages:</p>


<ul>
<li><p><strong class="pkg">Images</strong> 1.3</p>

</li>
<li><p><strong class="pkg">GRAPE</strong> 4.8</p>

</li>
<li><p><strong class="pkg">Design</strong> 1.7</p>

</li>
</ul>
<p>The following packages are also loaded, if available. They are needed for a limited number of <strong class="pkg">PAG</strong> functions.</p>


<ul>
<li><p><strong class="pkg">AssociationSchemes</strong> 2.0</p>

</li>
<li><p><strong class="pkg">DifSets</strong> 2.3.1</p>

</li>
<li><p><strong class="pkg">GUAVA</strong> 3.15</p>

</li>
</ul>
<p>The current installation file for <strong class="pkg">PAG</strong> is available at <span class="URL"><a href="https://vkrcadinac.github.io/PAG/">https://vkrcadinac.github.io/PAG/</a></span>. To install <strong class="pkg">PAG</strong>, unpack it to the <code class="file">pkg</code> directory of your local <strong class="pkg">GAP</strong> installation. The package uses external binaries. To compile them on UNIX-like environments, change to the <code class="file">pkg/PAG-*</code> directory and call</p>


<div class="example"><pre>
$ ./configure.sh
</pre></div>

<p>This produces a <code class="file">Makefile</code> in the current directory. Now call</p>


<div class="example"><pre>
$ make all
</pre></div>

<p>to compile the binares. They are placed in the <code class="file">bin</code> subdirectory. Documentation in the <code class="file">doc</code> subdirectory is already compiled and can be read in PDF, html or from within <strong class="pkg">GAP</strong>. To recompile the documentation, call <strong class="pkg">GAP</strong> with the <code class="file">makedoc.g</code> file.</p>

<p><a id="X87AF9F4C789605D1" name="X87AF9F4C789605D1"></a></p>

<h4>1.3 <span class="Heading">Examples: Designs</span></h4>

<p>The <strong class="pkg">PAG</strong> function <code class="code">KramerMesnerSearch</code> performs a search for <span class="SimpleMath">t</span>-designs with given parameters and a given permutation group as group of automorphisms. See the paper by B. Schmalz <a href="chapBib.html#biBBS93">[Sch93]</a> for an introduction to the Kramer-Mesner approach to constructing <span class="SimpleMath">t</span>-designs. Our first two examples are from this paper. The original paper of Earl Kramer and Dale Mesner is <a href="chapBib.html#biBKM76">[KM76]</a>.</p>

<p><a id="X85DE43FE83E85401" name="X85DE43FE83E85401"></a></p>

<h5>1.3-1 <span class="Heading">6-(14,7,4) Designs</span></h5>

<p>The summary about known 6-designs on page 130 of <a href="chapBib.html#biBBS93">[Sch93]</a> mentions that there are exactly two 6-(14,7,4) designs with cyclic derived designs. This means that the two 6-designs have automorphisms of order 13. They can be constructed by the following <strong class="pkg">GAP</strong> commands.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Group(CyclicPerm(13));</span>
Group([ (1,2,3,4,5,6,7,8,9,10,11,12,13) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=KramerMesnerSearch(6,14,7,4,g);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(d,AllTDesignLambdas);</span>
[ [ 1716, 858, 396, 165, 60, 18, 4 ], [ 1716, 858, 396, 165, 60, 18, 4 ] ]
</pre></div>

<p>The solver quickly finds 24 solutions of the Kramer-Mesner system. Most of the computation time is used to eliminate isomorphic designs. This can be turned off:</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d2:=KramerMesnerSearch(6,14,7,4,g,rec(NonIsomorphic:=false));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(d2);</span>
30
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(d2));</span>
24
</pre></div>

<p>Now we get a list of 30 designs. By default, A. Wassermann's LLL solver <a href="chapBib.html#biBAW98">[Was98]</a> is used; it may return the same solution more than once. The number of distinct designs is 24. The two non-isomorphic designs have <span class="SimpleMath">ℤ_13</span> as their full automorphism group.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(d,BlockDesignAut);</span>
[ Group([ (1,2,3,4,5,6,7,8,9,10,11,12,13) ]), 
  Group([ (1,2,3,4,5,6,7,8,9,10,11,12,13) ]) ]
</pre></div>

<p><a id="X7835113382A11FA1" name="X7835113382A11FA1"></a></p>

<h5>1.3-2 <span class="Heading">6-(28,8,<span class="SimpleMath">λ</span>) Designs</span></h5>

<p>In <a href="chapBib.html#biBBS93">[Sch93]</a>, the existence of 6-(28,8,<span class="SimpleMath">λ</span>) designs was established for <span class="SimpleMath">λ=42</span>, 63, 84, and 105. The exact numbers of these designs with automorphism group <span class="SimpleMath">PΓ L(2,27)</span> were computed. While the projective general linear groups are readily available in <strong class="pkg">GAP</strong> through the <code class="code">PGL</code> command, there seems to be no equivalent command for semilinear groups. We can get <span class="SimpleMath">PΓ L(2,27)</span> using the <strong class="pkg">FinInG</strong> package, as the collineation group of the projective line over <span class="SimpleMath">GF(27)</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">LoadPackage("FinInG");</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g1:=CollineationGroup(ProjectiveSpace(1,27));</span>
The FinInG collineation group PGammaL(2,27)
</pre></div>

<p>We need a permutation representation of this group on 28 points.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Image(ActionOnAllProjPoints(g1));</span>
Group([ (3,28,27,26,25,24,23,22,21,20,19,18,17,4,16,15,14,13,12,11,10,9,8,7,6,5), 
  (1,2,4)(5,8,24)(6,21,10)(7,16,15)(9,25,28)(11,13,14)(12,27,23)(17,26,18)
  (19,20,22), (5,7,13)(6,10,21)(8,16,14)(9,18,22)(11,24,15)(12,27,23)(17,19,25)
  (20,28,26) ])
</pre></div>

<p>Alternatively, we can get <span class="SimpleMath">PΓ L(2,27)</span> from the library of small primitive permutation groups.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PrimitiveGroupsOfDegree(28);</span>
[ PGL(2, 7), PSL(2, 8), PGammaL(2, 8), PSU(3, 3), PGammaU(3, 3), PSp(6, 2), A(8), 
  S(8), PSL(2, 27), PGL(2, 27), PSL(2, 27):3, PGammaL(2, 27), A(28), S(28) ]
</pre></div>

<p>Now we can construct the designs with <span class="SimpleMath">λ=42</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=KramerMesnerSearch(6,28,8,42,g,rec(BaseBlocks:=true));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(d));</span>
3
</pre></div>

<p>Most of the CPU time in the example above was used to compute the Kramer-Mesner matrix. The left side of the Kramer-Mesner system is the same matrix for all <span class="SimpleMath">λ</span>, so we can compute it once and reuse it to save time.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">tsub:=SubsetOrbitRep(g,28,6);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ksub:=SubsetOrbitRep(g,28,8);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">m:=KramerMesnerMat(g,tsub,ksub);;</span>
</pre></div>

<p>Now we can quickly get the exact numbers of designs from the paper <a href="chapBib.html#biBBS93">[Sch93]</a>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(SolveKramerMesner(ExpandMatRHS(m,42))));</span>
3
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(SolveKramerMesner(ExpandMatRHS(m,63))));</span>
367
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(SolveKramerMesner(ExpandMatRHS(m,84))));</span>
21743
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(AsSet(SolveKramerMesner(ExpandMatRHS(m,105))));</span>
38277
</pre></div>

<p><a id="X82F01F238596D36C" name="X82F01F238596D36C"></a></p>

<h5>1.3-3 <span class="Heading">2-(81,6,2) Designs</span></h5>

<p>The first simple 2-(81,6,2) design was recently found by A. Nakic <a href="chapBib.html#biBAN21">[Nak21]</a>. Here are the base blocks of this design copy-pasted from the paper.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">bb:=[[[0,0,0,0],[0,0,0,1],[0,0,0,2],[0,1,0,0],[0,1,0,1],[0,1,0,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[0,0,1,1],[0,0,2,2],[2,1,0,0],[2,1,1,1],[2,1,2,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[0,1,1,1],[0,2,2,2],[0,0,1,0],[0,1,2,1],[0,2,0,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[0,1,2,0],[0,2,1,0],[2,0,2,1],[2,1,1,1],[2,2,0,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,0,0,0],[2,0,0,0],[0,2,2,1],[1,2,2,1],[2,2,2,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,0,1,0],[2,0,2,0],[0,1,0,0],[1,1,1,0],[2,1,2,0]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,0,1,1],[2,0,2,2],[0,0,2,0],[1,0,0,1],[2,0,1,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,0,2,0],[2,0,1,0],[0,2,1,1],[1,2,0,1],[2,2,2,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,0,2,2],[2,0,1,1],[0,1,2,1],[1,1,1,0],[2,1,0,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,1,0,0],[2,2,0,0],[0,2,0,1],[1,0,0,1],[2,1,0,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,1,0,1],[2,2,0,2],[0,2,2,0],[1,0,2,1],[2,1,2,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,1,2,0],[2,2,1,0],[0,0,2,1],[1,1,1,1],[2,2,0,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,1,2,1],[2,2,1,2],[0,2,1,1],[1,0,0,2],[2,1,2,0]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,1,2,2],[2,2,1,1],[0,2,2,0],[1,0,1,2],[2,1,0,1]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,2,1,2],[2,1,2,1],[0,0,2,1],[1,2,0,0],[2,1,1,2]],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">[[0,0,0,0],[1,2,2,0],[2,1,1,0],[0,2,2,1],[1,1,1,1],[2,0,0,1]]]*Z(3)^0;;</span>
</pre></div>

<p>The points of this design are elements of the 4-dimensional vector space <span class="SimpleMath">V</span> over <span class="SimpleMath">GF(3)</span>. Here is how to get the desing in the <strong class="pkg">Design</strong> package format.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">V:=Tuples([0,1,2],4)*Z(3)^0;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d1:=Union(List(bb,y-&gt;List(V,x-&gt;AsSet(x+y))));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=BlockDesign(81,List(d1,y-&gt;List(y,x-&gt;Position(V,x))));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AllTDesignLambdas(d);</span>
[ 432, 32, 2 ]
</pre></div>

<p>The full automorphism group of the design is of order 2592. It is a semidirect product of the additive group of <span class="SimpleMath">V</span> and a group of order 32.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">aut:=BlockDesignAut(d);</span>
&lt;permutation group with 5 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(aut);</span>
2592
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StructureDescription(aut);</span>
"(C3 x C3 x C3 x C3) : (C16 : C2)"
</pre></div>

<p>This group has three subgroups of order 648 up to conjugation. We can use the second subgroup to construct four more simple 2-(81,6,2) designs.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Filtered(AllSubgroupsConjugation(aut),x-&gt;Size(x)=648);</span>
[ &lt;permutation group of size 648 with 7 generators&gt;, 
  &lt;permutation group of size 648 with 7 generators&gt;, 
  &lt;permutation group of size 648 with 7 generators&gt; ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dd:=KramerMesnerSearch(2,81,6,2,g[2]);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(dd,x-&gt;Size(AutomorphismGroup(x)));</span>
[ 1296, 2592, 3888, 1944, 15552 ]
</pre></div>

<p>Two of the new designs have larger full automorphism groups than the design from <a href="chapBib.html#biBAN21">[Nak21]</a>. Using their subgroups, more simple 2-(81,6,2) designs can be constructed.</p>

<p><a id="X7C9ADE74821A9A39" name="X7C9ADE74821A9A39"></a></p>

<h5>1.3-4 <span class="Heading">Quasi-symmetric 2-(56,16,18) Designs</span></h5>

<p>Here is how the quasi-symmetric 2-(56,16,18) designs with intersection numbers <span class="SimpleMath">x=4</span>, <span class="SimpleMath">y=8</span> from the paper <a href="chapBib.html#biBKV16">[KV16]</a> can be constructed.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Group((1,2,3,4,5)(6,7,8,9,10)(11,12,13,14,15)(16,17,18,19,20)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">  (21,22,23,24,25)(26,27,28,29,30)(31,32,33,34,35)(36,37,38,39,40)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">  (41,42,43,44,45)(46,47,48,49,50)(51,52,53,54,55),</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">(1,6,8)(2,21,26)(3,32,34)(4,11,5)(7,15,22)(9,16,13)(10,29,17)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">  (12,33,30)(14,19,31)(18,23,35)(24,28,36)(25,37,39)(27,38,40)</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">  (42,51,49)(43,52,45)(44,46,47)(48,54,53)(50,56,55));</span>
&lt;permutation group with 2 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=KramerMesnerSearch(2,56,16,18,g,rec(IntersectionNumbers:=[4,8]));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(d);</span>
3
</pre></div>

<p>We check that they have all required properties and compute their full automorphism groups:</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(d,AllTDesignLambdas);</span>
[ [ 231, 66, 18 ], [ 231, 66, 18 ], [ 231, 66, 18 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(d,IntersectionNumbers);</span>
[ [ 4, 8 ], [ 4, 8 ], [ 4, 8 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">aut:=List(d,BlockDesignAut);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(aut,StructureDescription);</span>
[ "(C2 x C2 x C2 x C2) : S5", "(C2 x C2 x C2 x C2) : A5", "PSL(3,4) : C2" ]
</pre></div>

<p><a id="X7CCA2066781B6D56" name="X7CCA2066781B6D56"></a></p>

<h4>1.4 <span class="Heading">Examples: Latin Squares</span></h4>

<p>See <a href="chapBib.html#biBKD15">[KD15]</a> for an introduction to Latin squares and definitions of isotopy, paratopy, etc. Multiplication tables of groups are examples of Latin squares.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">CayleyTableOfGroup(CyclicGroup(7));</span>
[ [ 1, 2, 3, 4, 5, 6, 7 ], 
  [ 2, 3, 4, 5, 6, 7, 1 ], 
  [ 3, 4, 5, 6, 7, 1, 2 ], 
  [ 4, 5, 6, 7, 1, 2, 3 ], 
  [ 5, 6, 7, 1, 2, 3, 4 ], 
  [ 6, 7, 1, 2, 3, 4, 5 ], 
  [ 7, 1, 2, 3, 4, 5, 6 ] ]
</pre></div>

<p>We can construct more examples by prescribing symmetry groups. The <strong class="pkg">PAG</strong> function <code class="code">KramerMesnerMOLS</code> performs a search for sets of <span class="SimpleMath">s</span> mutually orthogonal Latin squares (MOLS) of order <span class="SimpleMath">n</span> and a given permutation group as autotopy or autoparatopy group. The group must act on the <span class="SimpleMath">s+2</span> point classes of the corresponding transversal design. By <a href="chapBib.html#biBRF12">[Fal12]</a> and <a href="chapBib.html#biBSVW12">[SVW12]</a>, an autotopism of order 5 of a Latin square of order 7 must have the following cycle structure.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a:=MultiPerm(CyclicPerm(5),[1..7],3);</span>
(1,2,3,4,5)(8,9,10,11,12)(15,16,17,18,19)
</pre></div>

<p>There are two main classes of such Latin squares. They are multiplication tables of non-associative quasigroups.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">KramerMesnerMOLS(7,1,Group(a));</span>
[ [ [ [ 1, 3, 2, 6, 7, 4, 5 ], 
          [ 7, 2, 4, 3, 6, 5, 1 ], 
          [ 6, 7, 3, 5, 4, 1, 2 ], 
          [ 5, 6, 7, 4, 1, 2, 3 ], 
          [ 2, 1, 6, 7, 5, 3, 4 ], 
          [ 3, 4, 5, 1, 2, 6, 7 ], 
          [ 4, 5, 1, 2, 3, 7, 6 ] ] ], 
  [ [ [ 1, 3, 5, 6, 7, 2, 4 ], 
          [ 7, 2, 4, 1, 6, 3, 5 ], 
          [ 6, 7, 3, 5, 2, 4, 1 ], 
          [ 3, 6, 7, 4, 1, 5, 2 ], 
          [ 2, 4, 6, 7, 5, 1, 3 ], 
          [ 4, 5, 1, 2, 3, 6, 7 ], 
          [ 5, 1, 2, 3, 4, 7, 6 ] ] ] ]
</pre></div>

<p>Single Latin squares are treated as MOLS sets of size <span class="SimpleMath">s=1</span>, hence the excess brackets. When the order <span class="SimpleMath">n</span> is a prime power, complete sets of <span class="SimpleMath">s=n-1</span> MOLS are easily constructed from finite fields.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ls4:=FieldToMOLS(GF(4));</span>
[ [ [ 1, 2, 3, 4 ], 
      [ 2, 1, 4, 3 ], 
      [ 3, 4, 1, 2 ], 
      [ 4, 3, 2, 1 ] ], 
  [ [ 1, 2, 3, 4 ], 
      [ 3, 4, 1, 2 ], 
      [ 4, 3, 2, 1 ], 
      [ 2, 1, 4, 3 ] ], 
  [ [ 1, 2, 3, 4 ], 
      [ 4, 3, 2, 1 ], 
      [ 2, 1, 4, 3 ], 
      [ 3, 4, 1, 2 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AreMOLS(ls4);</span>
true
</pre></div>

<p>The package <strong class="pkg">Guava</strong> contains a function <code class="func">AreMOLS</code> (<a href="/opt/gap-4.11.1/pkg/guava-3.15/doc/chap7.html#X81B9B40B7B2D97D5"><span class="RefLink">GUAVA: AreMOLS</span></a>) to test sets of MOLS. A famous problem is to find MOLS of order 10. The Handbook of Combinatorial Designs <a href="chapBib.html#biBCD07">[CD07]</a>, III.5.6 contains an example of a 1-diagonally cyclic self-orthogonal Latin square <span class="SimpleMath">L</span> of order 10. Self-orthogonal means that <span class="SimpleMath">L</span> is orthogonal to its transpose. In other words, the MOLS set <span class="SimpleMath">{L,L^t}</span> is invariant under the following conjugation, simultaneously exchanging rows–columns and the two Latin squares.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c:=Sortex(Concatenation([11..20],[1..10],[31..40],[21..30]));</span>
(1,11)(2,12)(3,13)(4,14)(5,15)(6,16)(7,17)(8,18)(9,19)(10,20)(21,
31)(22,32)(23,33)(24,34)(25,35)(26,36)(27,37)(28,38)(29,39)(30,40)
</pre></div>

<p>Furthermore, the example from <a href="chapBib.html#biBCD07">[CD07]</a> has an autotopism of order 9.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a:=MultiPerm(CyclicPerm(9),[1..10],4);</span>
(1,2,3,4,5,6,7,8,9)(11,12,13,14,15,16,17,18,19)(21,22,23,24,25,26,
27,28,29)(31,32,33,34,35,36,37,38,39)
</pre></div>

<p>The permutations <span class="SimpleMath">a</span> and <span class="SimpleMath">c</span> generate an autoparatopy group of order 18 we can use to construct the example.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=Group(a,c);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(g);</span>
18
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ls10:=KramerMesnerMOLS(10,2,g);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(ls10,AreMOLS);</span>
[ true, true, true, true, true ]
</pre></div>

<p>We see that there are 5 inequivalent pairs of MOLS with <span class="SimpleMath">g</span> as autoparatopy group. Here is one pair.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ls10[1];</span>
[ [ [ 1, 3, 6, 9, 2, 10, 5, 7, 4, 8 ], 
      [ 5, 2, 4, 7, 1, 3, 10, 6, 8, 9 ], 
      [ 9, 6, 3, 5, 8, 2, 4, 10, 7, 1 ], 
      [ 8, 1, 7, 4, 6, 9, 3, 5, 10, 2 ], 
      [ 10, 9, 2, 8, 5, 7, 1, 4, 6, 3 ], 
      [ 7, 10, 1, 3, 9, 6, 8, 2, 5, 4 ], 
      [ 6, 8, 10, 2, 4, 1, 7, 9, 3, 5 ], 
      [ 4, 7, 9, 10, 3, 5, 2, 8, 1, 6 ], 
      [ 2, 5, 8, 1, 10, 4, 6, 3, 9, 7 ], 
      [ 3, 4, 5, 6, 7, 8, 9, 1, 2, 10 ] ], 
  [ [ 1, 5, 9, 8, 10, 7, 6, 4, 2, 3 ], 
      [ 3, 2, 6, 1, 9, 10, 8, 7, 5, 4 ], 
      [ 6, 4, 3, 7, 2, 1, 10, 9, 8, 5 ], 
      [ 9, 7, 5, 4, 8, 3, 2, 10, 1, 6 ], 
      [ 2, 1, 8, 6, 5, 9, 4, 3, 10, 7 ], 
      [ 10, 3, 2, 9, 7, 6, 1, 5, 4, 8 ], 
      [ 5, 10, 4, 3, 1, 8, 7, 2, 6, 9 ], 
      [ 7, 6, 10, 5, 4, 2, 9, 8, 3, 1 ], 
      [ 4, 8, 7, 10, 6, 5, 3, 1, 9, 2 ], 
      [ 8, 9, 1, 2, 3, 4, 5, 6, 7, 10 ] ] ]
</pre></div>

<p><a id="X7B532D6B81CC1FC2" name="X7B532D6B81CC1FC2"></a></p>

<h4>1.5 <span class="Heading">Examples: Cubes of Symmetric Designs</span></h4>

<p>Cubes of symmetric designs are studied in the paper <a href="chapBib.html#biBKPT23">[KPT23]</a>. Here is an example.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c:=DifferenceCube(Group((1,2,3,4,5,6,7)),[1,2,4],3);</span>
[ [ [ 1, 1, 0, 1, 0, 0, 0 ], 
     [ 1, 0, 1, 0, 0, 0, 1 ], 
     [ 0, 1, 0, 0, 0, 1, 1 ], 
     [ 1, 0, 0, 0, 1, 1, 0 ], 
     [ 0, 0, 0, 1, 1, 0, 1 ], 
     [ 0, 0, 1, 1, 0, 1, 0 ], 
     [ 0, 1, 1, 0, 1, 0, 0 ] ], 
  [ [ 1, 0, 1, 0, 0, 0, 1 ], 
     [ 0, 1, 0, 0, 0, 1, 1 ], 
     [ 1, 0, 0, 0, 1, 1, 0 ], 
     [ 0, 0, 0, 1, 1, 0, 1 ], 
     [ 0, 0, 1, 1, 0, 1, 0 ], 
     [ 0, 1, 1, 0, 1, 0, 0 ], 
     [ 1, 1, 0, 1, 0, 0, 0 ] ], 
  [ [ 0, 1, 0, 0, 0, 1, 1 ], 
      [ 1, 0, 0, 0, 1, 1, 0 ], 
      [ 0, 0, 0, 1, 1, 0, 1 ], 
      [ 0, 0, 1, 1, 0, 1, 0 ], 
      [ 0, 1, 1, 0, 1, 0, 0 ], 
      [ 1, 1, 0, 1, 0, 0, 0 ], 
      [ 1, 0, 1, 0, 0, 0, 1 ] ], 
  [ [ 1, 0, 0, 0, 1, 1, 0 ], 
      [ 0, 0, 0, 1, 1, 0, 1 ], 
      [ 0, 0, 1, 1, 0, 1, 0 ], 
      [ 0, 1, 1, 0, 1, 0, 0 ], 
      [ 1, 1, 0, 1, 0, 0, 0 ], 
      [ 1, 0, 1, 0, 0, 0, 1 ], 
      [ 0, 1, 0, 0, 0, 1, 1 ] ], 
  [ [ 0, 0, 0, 1, 1, 0, 1 ], 
      [ 0, 0, 1, 1, 0, 1, 0 ], 
      [ 0, 1, 1, 0, 1, 0, 0 ], 
      [ 1, 1, 0, 1, 0, 0, 0 ], 
      [ 1, 0, 1, 0, 0, 0, 1 ], 
      [ 0, 1, 0, 0, 0, 1, 1 ], 
      [ 1, 0, 0, 0, 1, 1, 0 ] ], 
  [ [ 0, 0, 1, 1, 0, 1, 0 ], 
      [ 0, 1, 1, 0, 1, 0, 0 ], 
      [ 1, 1, 0, 1, 0, 0, 0 ], 
      [ 1, 0, 1, 0, 0, 0, 1 ], 
      [ 0, 1, 0, 0, 0, 1, 1 ], 
      [ 1, 0, 0, 0, 1, 1, 0 ], 
      [ 0, 0, 0, 1, 1, 0, 1 ] ], 
  [ [ 0, 1, 1, 0, 1, 0, 0 ], 
      [ 1, 1, 0, 1, 0, 0, 0 ], 
      [ 1, 0, 1, 0, 0, 0, 1 ], 
      [ 0, 1, 0, 0, 0, 1, 1 ], 
      [ 1, 0, 0, 0, 1, 1, 0 ], 
      [ 0, 0, 0, 1, 1, 0, 1 ], 
      [ 0, 0, 1, 1, 0, 1, 0 ] ] ]
</pre></div>

<p>This is a <span class="SimpleMath">3</span>-dimensional array of zeros and ones such that all <span class="SimpleMath">2</span>-dimensional slices are incidence matrices of <span class="SimpleMath">(7,3,1)</span> designs. For example, here is a slice obtained by varying coordinates <span class="SimpleMath">1,3</span> and setting coordinate <span class="SimpleMath">2</span> to <span class="SimpleMath">7</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">m:=CubeSlice(c,1,3,[7]);</span>
[ [ 0, 1, 1, 0, 1, 0, 0 ], 
  [ 1, 1, 0, 1, 0, 0, 0 ], 
  [ 1, 0, 1, 0, 0, 0, 1 ], 
  [ 0, 1, 0, 0, 0, 1, 1 ], 
  [ 1, 0, 0, 0, 1, 1, 0 ], 
  [ 0, 0, 0, 1, 1, 0, 1 ], 
  [ 0, 0, 1, 1, 0, 1, 0 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">m*TransposedMat(m);</span>
[ [ 3, 1, 1, 1, 1, 1, 1 ], 
  [ 1, 3, 1, 1, 1, 1, 1 ], 
  [ 1, 1, 3, 1, 1, 1, 1 ], 
  [ 1, 1, 1, 3, 1, 1, 1 ], 
  [ 1, 1, 1, 1, 3, 1, 1 ], 
  [ 1, 1, 1, 1, 1, 3, 1 ], 
  [ 1, 1, 1, 1, 1, 1, 3 ] ]
</pre></div>

<p>A cube of arbitrary dimension <span class="SimpleMath">nge 2</span> can be constructed from a difference set in a group by calling <code class="func">DifferenceCube</code> (<a href="chap2.html#X796E426D877E220A"><span class="RefLink">2.6-1</span></a>). The function uses the representation of difference sets from the <strong class="pkg">DifSets</strong> package <a href="/opt/gap-4.11.1/pkg/difsets-2.3.1/doc/chap1.html#X8248A9AB7E689C64"><span class="RefLink">DifSets: Difference Sets</span></a>. For <span class="SimpleMath">n=2</span>, the difference cube is simply an incidence matrix of the associated symmetric design, i.e. the development of the difference set.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=SmallGroup(15,1);</span>
&lt;pc group of size 15 with 2 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StructureDescription(g);</span>
"C15"
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ds:=DifferenceSets(g);</span>
[ [ 1, 2, 3, 4, 8, 11, 12 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">m:=DifferenceCube(g,ds[1],2);</span>
[ [ 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0 ], 
  [ 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1 ], 
  [ 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1 ], 
  [ 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0 ], 
  [ 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1 ], 
  [ 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0 ], 
  [ 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1 ], 
  [ 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1 ], 
  [ 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0 ], 
  [ 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0 ], 
  [ 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0 ], 
  [ 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0 ], 
  [ 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1 ], 
  [ 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0 ], 
  [ 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=BlockDesign(15,List(m,x-&gt;Positions(x,1)));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AllTDesignLambdas(d);</span>
[ 15, 7, 3 ]
</pre></div>

<p>The function <code class="func">DifferenceSets</code> (<a href="/opt/gap-4.11.1/pkg/difsets-2.3.1/doc/chap2.html#X83297D2B85F9E074"><span class="RefLink">DifSets: DifferenceSets</span></a>) returns a list of all difference sets up to equivalence in a given group. Here is a small <span class="SimpleMath">4</span>-dimensional <span class="SimpleMath">(3,2,1)</span> cube.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c:=DifferenceCube(Group((1,2,3)),[1,2],4);</span>
[ [ [ [ 1, 1, 0 ], [ 1, 0, 1 ], [ 0, 1, 1 ] ], 
      [ [ 1, 0, 1 ], [ 0, 1, 1 ], [ 1, 1, 0 ] ], 
      [ [ 0, 1, 1 ], [ 1, 1, 0 ], [ 1, 0, 1 ] ] ], 
  [ [ [ 1, 0, 1 ], [ 0, 1, 1 ], [ 1, 1, 0 ] ], 
      [ [ 0, 1, 1 ], [ 1, 1, 0 ], [ 1, 0, 1 ] ], 
      [ [ 1, 1, 0 ], [ 1, 0, 1 ], [ 0, 1, 1 ] ] ], 
  [ [ [ 0, 1, 1 ], [ 1, 1, 0 ], [ 1, 0, 1 ] ], 
      [ [ 1, 1, 0 ], [ 1, 0, 1 ], [ 0, 1, 1 ] ], 
      [ [ 1, 0, 1 ], [ 0, 1, 1 ], [ 1, 1, 0 ] ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">CubeTest(c);</span>
[ [ 3, 2, 1 ] ]
</pre></div>

<p>The function <code class="func">CubeTest</code> (<a href="chap2.html#X7B79A7857DAD2FFE"><span class="RefLink">2.6-10</span></a>) looks at all possible slices and checks if they are incidence matrices of <span class="SimpleMath">(v,k,λ)</span> designs. In the next example we construct all <span class="SimpleMath">3</span>-dimensional difference cubes of order <span class="SimpleMath">21</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=AllSmallGroups(21);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(g,StructureDescription);</span>
[ "C7 : C3", "C21" ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ds:=List(g,DifferenceSets);</span>
[ [ [ 1, 2, 3, 9, 10 ] ], [ [ 1, 2, 7, 10, 16 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c1:=DifferenceCube(g[1],ds[1][1],3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c2:=DifferenceCube(g[2],ds[2][1],3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List([c1,c2],CubeTest);</span>
[ [ [ 21, 5, 1 ] ], [ [ 21, 5, 1 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(CubeAut(c1));</span>
1323
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(CubeAut(c2));</span>
2646
</pre></div>

<p>The function <code class="func">CubeAut</code> (<a href="chap2.html#X7E96F84678D23676"><span class="RefLink">2.6-12</span></a>) computes the full autotopy group of a cube. By setting options, full autoparatopy groups can also be obtained. We can make a non-difference cube by the "group cube" construction of Theorem 4.1 from <a href="chapBib.html#biBKPT23">[KPT23]</a>. First we search for all <span class="SimpleMath">(21,5,1)</span> designs with blocks being difference sets in the Frobenius group of order <span class="SimpleMath">21</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">allds:=Filtered(Combinations([1..21],5),x-&gt;IsDifferenceSet(g[1],x));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(allds);</span>
294
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">A:=KramerMesnerMat(Group(()),Combinations([1..21],2),allds,1,21);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PAGGlobalOptions.Silent:=true;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">sol:=AsSet(SolveKramerMesner(A));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">des:=List(sol,x-&gt;BaseBlocks(allds,x));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(des);</span>
70
</pre></div>

<p>Among these <span class="SimpleMath">70</span> designs, <span class="SimpleMath">14</span> are left developments, and <span class="SimpleMath">14</span> are right developments. The remaining <span class="SimpleMath">42</span> designs are not developments, but all of their blocks are difference sets.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dev1:=AsSet(List(allds,x-&gt;LeftDevelopment(g[1],x).blocks));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(dev1);</span>
14
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dev2:=AsSet(List(allds,x-&gt;RightDevelopment(g[1],x).blocks));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(dev2);</span>
14
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">nondev:=Difference(des,Union(dev1,dev2));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(nondev);</span>
42
</pre></div>

<p>Now we apply the group cube construction to these <span class="SimpleMath">42</span> designs. The obtained cubes are equivalent.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">cc:=List(nondev,x-&gt;GroupCube(g[1],x,3));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(CubeFilter(cc));</span>
1
</pre></div>

<p>The function <code class="func">CubeFilter</code> (<a href="chap2.html#X810B22E286D857C1"><span class="RefLink">2.6-13</span></a>) eliminates equivalent copies from a list of cubes. Our new cube is not equivalent with the two <span class="SimpleMath">(21,5,1)</span> difference cubes.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">c3:=cc[1];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">CubeTest(c3);</span>
[ [ 21, 5, 1 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(CubeFilter([c1,c2,c3]));</span>
3
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(CubeAut(c3));</span>
441
</pre></div>

<p>However, the three cubes have the same slice invariant; see <a href="chapBib.html#biBKPT23">[KPT23]</a> for the definition.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List([c1,c2,c3],SliceInvariant);</span>
[ [ [ [ [ 120960, 21 ] ], 3 ] ], [ [ [ [ 120960, 21 ] ], 3 ] ], 
  [ [ [ [ 120960, 21 ] ], 3 ] ] ]
</pre></div>

<p>Cubes with slice invariants different from any difference cube can be constructed for parameters of the form <span class="SimpleMath">(4^m,2^m-1(2^m-1),2^m-1(2^m-1-1))</span>, <span class="SimpleMath">mge 2</span>.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">m:=2;; n:=3;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">cl:=List([1,2,3],i-&gt;GroupCube(SDPSeriesGroup(m),SDPSeriesDesign(m,i),n));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(cl,CubeTest);</span>
[ [ [ 16, 6, 2 ] ], [ [ 16, 6, 2 ] ], [ [ 16, 6, 2 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(cl,SliceInvariant);</span>
[ [ [ [ [ 11520, 16 ] ], 3 ] ], 
  [ [ [ [ 768, 16 ] ], 2 ], [ [ [ 11520, 16 ] ], 1 ] ], 
  [ [ [ [ 384, 16 ] ], 2 ], [ [ [ 11520, 16 ] ], 1 ] ] ]
</pre></div>

<p>The first cube in the list <code class="code">cl</code> is a difference cube. The other two cubes are not, because they have non-isomorphic slices in different directions. This construction works for all <span class="SimpleMath">mge 2</span> and dimensions <span class="SimpleMath">nge 3</span>, but it takes a lot of time and memory for bigger values of <span class="SimpleMath">m</span> and <span class="SimpleMath">n</span>. We classified all 3-dimensional group cubes of <span class="SimpleMath">(16,6,2)</span> designs; they are available at <span class="URL"><a href="https://web.math.pmf.unizg.hr/~krcko/results/cubes.html">https://web.math.pmf.unizg.hr/~krcko/results/cubes.html</a></span>. A list of 1423 non-group cubes of <span class="SimpleMath">(16,6,2)</span> designs is also provided.</p>

<p>The package <strong class="pkg">DifSets</strong> contains precomputed lists of difference sets up to equivalence. They are loaded by the function <code class="func">LoadDifferenceSets</code> (<a href="/opt/gap-4.11.1/pkg/difsets-2.3.1/doc/chap2.html#X848925877C3C891F"><span class="RefLink">DifSets: LoadDifferenceSets</span></a>). We can use them to compute all difference cubes up to equivalence.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">v:=27;</span>
27
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l1:=Concatenation(List([1..NrSmallGroups(v)],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">i-&gt;List(LoadDifferenceSets(v,i),x-&gt;[i,x])));</span>
[ [ 4, [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ] ], 
  [ 4, [ 1, 2, 3, 4, 5, 7, 8, 9, 13, 15, 18, 19, 23 ] ], 
  [ 5, [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 15, 23, 25, 27 ] ] ]
</pre></div>

<p>The list <code class="code">l1</code> now contains all inequivalent difference sets in groups of order 27. The first entry is the group ID from the <strong class="pkg">GAP</strong> library of small groups, followed by the difference set.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StructureDescription(SmallGroup(27,4));</span>
"C9 : C3"
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StructureDescription(SmallGroup(27,5));</span>
"C3 x C3 x C3"
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l2:=List(l1,x-&gt;DifferenceCube(SmallGroup(v,x[1]),x[2],3));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l3:=l1{CubeFilter(l2,rec(Positions:=true))};</span>
[ [ 4, [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ] ], 
  [ 5, [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 15, 23, 25, 27 ] ] ]
</pre></div>

<p>The list <code class="code">l3</code> contains difference sets giving 3-cubes that are inequivalent (not paratopic). Notice that the two cubes arising from difference sets in <span class="SimpleMath">ℤ_9⋊ ℤ_3</span> (group ID 4) are paratopic, but not isotopic:</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l4:=l1{CubeFilter(l2,rec(Positions:=true,Isotopy:=true))};</span>
[ [ 4, [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ] ], 
  [ 4, [ 1, 2, 3, 4, 5, 7, 8, 9, 13, 15, 18, 19, 23 ] ], 
  [ 5, [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 15, 23, 25, 27 ] ] ]
</pre></div>

<p>We will now construct some non-difference group cubes in <span class="SimpleMath">ℤ_9⋊ ℤ_3</span>. Here is an efficient way to get all difference sets, including equivalent ones.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=SmallGroup(v,4);</span>
&lt;pc group of size 27 with 3 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ge:=ExtendedPermRepresentation(g);</span>
&lt;permutation group with 7 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ds:=LoadDifferenceSets(v,4);</span>
[ [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ], 
  [ 1, 2, 3, 4, 5, 7, 8, 9, 13, 15, 18, 19, 23 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">allds:=Union(List(ds,x-&gt;Orbit(ge,x,OnSets)));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(allds);</span>
972
</pre></div>

<p>For parameters <span class="SimpleMath">(21,5,1)</span> we could search for all designs with difference sets as blocks. This would take too much time for <span class="SimpleMath">(27,13,6)</span>, so we prescribe an automorphism group of order 3.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">sub:=AllSubgroupsConjugation(ge);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">h:=sub[4];</span>
Group([ (1,10,4)(2,15,7)(3,17,9)(5,20,12)(6,22,14)(8,23,16)
  (11,25,19)(13,26,21)(18,27,24) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">alldsorb:=List(Orbits(h,allds,OnSets),Representative);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(alldsorb);</span>
324
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">pairsorb:=List(Orbits(h,Combinations([1..27],2),OnSets),Representative);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(pairsorb);</span>
117
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">A:=KramerMesnerMat(h,pairsorb,alldsorb,6,27);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">sol:=AsSet(SolveKramerMesner(A));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">des:=List(sol,x-&gt;BlockDesign(27,BaseBlocks(alldsorb,x),h).blocks);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(des);</span>
288
</pre></div>

<p>We get 288 designs with difference sets as blocks. Let us remove the ones which are developments of their blocks.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dev1:=AsSet(List(allds,x-&gt;LeftDevelopment(g,x).blocks));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dev2:=AsSet(List(allds,x-&gt;RightDevelopment(g,x).blocks));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">nondev:=List(Difference(des,Union(dev1,dev2)),x-&gt;[4,x]);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(nondev);</span>
216
</pre></div>

<p>Next, we remove the ones leading to equivalent 3-cubes.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">cc:=List(nondev,x-&gt;GroupCube(SmallGroup(v,x[1]),x[2],3));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l5:=nondev{CubeFilter(cc,rec(Positions:=true))};</span>
[ [ 4, 
      [ [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ], 
          [ 1, 2, 3, 4, 5, 7, 10, 13, 14, 19, 21, 22, 24 ], 
          [ 1, 2, 3, 7, 11, 12, 13, 15, 20, 23, 24, 25, 27 ], 
          [ 1, 2, 4, 6, 10, 11, 13, 14, 15, 17, 18, 20, 26 ], 
          [ 1, 2, 4, 8, 9, 12, 13, 16, 17, 18, 22, 24, 27 ], 
          [ 1, 2, 9, 10, 11, 14, 16, 17, 19, 21, 23, 25, 27 ], 
          [ 1, 3, 4, 7, 8, 11, 17, 18, 19, 22, 23, 25, 26 ], 
          [ 1, 3, 5, 8, 9, 10, 14, 15, 18, 23, 24, 26, 27 ], 
          [ 1, 3, 5, 8, 10, 11, 12, 15, 16, 17, 20, 21, 22 ], 
          [ 1, 4, 6, 7, 9, 10, 12, 15, 21, 22, 25, 26, 27 ], 
          [ 1, 5, 6, 7, 9, 11, 14, 16, 18, 20, 22, 24, 25 ], 
          [ 1, 5, 6, 8, 13, 17, 19, 20, 21, 24, 25, 26, 27 ], 
          [ 1, 6, 7, 8, 12, 13, 14, 15, 16, 18, 19, 21, 23 ], 
          [ 2, 3, 5, 6, 9, 13, 15, 17, 18, 21, 22, 23, 25 ], 
          [ 2, 3, 6, 7, 8, 9, 11, 12, 14, 17, 21, 24, 26 ], 
          [ 2, 3, 6, 8, 10, 12, 14, 18, 19, 20, 22, 25, 27 ], 
          [ 2, 4, 5, 7, 8, 9, 11, 15, 18, 19, 20, 21, 27 ], 
          [ 2, 4, 8, 14, 15, 16, 20, 21, 22, 23, 24, 25, 26 ], 
          [ 2, 5, 6, 7, 8, 10, 11, 13, 16, 22, 23, 26, 27 ], 
          [ 2, 5, 7, 10, 12, 15, 16, 17, 18, 19, 24, 25, 26 ], 
          [ 3, 4, 5, 11, 12, 13, 14, 16, 18, 21, 25, 26, 27 ], 
          [ 3, 4, 6, 7, 10, 16, 17, 18, 20, 21, 23, 24, 27 ], 
          [ 3, 4, 6, 8, 9, 10, 11, 13, 15, 16, 19, 24, 25 ], 
          [ 3, 7, 9, 13, 14, 15, 16, 17, 19, 20, 22, 26, 27 ], 
          [ 4, 5, 6, 11, 12, 14, 15, 17, 19, 22, 23, 24, 27 ], 
          [ 4, 5, 7, 8, 9, 10, 12, 13, 14, 17, 20, 23, 25 ], 
          [ 9, 10, 11, 12, 13, 18, 19, 20, 21, 22, 23, 24, 26 ] ] ], 
  [ 4, 
      [ [ 1, 2, 3, 4, 5, 6, 9, 12, 16, 19, 20, 23, 26 ], 
          [ 1, 2, 3, 5, 7, 11, 14, 15, 18, 20, 23, 24, 25 ], 
          [ 1, 2, 3, 7, 9, 13, 14, 17, 19, 20, 21, 22, 27 ], 
          [ 1, 2, 4, 6, 7, 8, 10, 11, 13, 18, 20, 22, 26 ], 
          [ 1, 2, 4, 10, 12, 14, 15, 21, 22, 23, 25, 26, 27 ], 
          [ 1, 2, 5, 8, 12, 13, 17, 18, 19, 21, 24, 25, 26 ], 
          [ 1, 3, 4, 6, 8, 11, 13, 15, 17, 19, 23, 25, 27 ], 
          [ 1, 3, 5, 8, 10, 11, 12, 15, 16, 17, 20, 21, 22 ], 
          [ 1, 3, 6, 7, 8, 9, 10, 12, 18, 21, 23, 24, 27 ], 
          [ 1, 4, 5, 6, 7, 10, 13, 14, 15, 16, 19, 21, 24 ], 
          [ 1, 4, 8, 9, 14, 15, 16, 17, 18, 20, 24, 26, 27 ], 
          [ 1, 5, 6, 9, 11, 12, 13, 14, 16, 18, 22, 25, 27 ], 
          [ 1, 7, 9, 10, 11, 16, 17, 19, 22, 23, 24, 25, 26 ], 
          [ 2, 3, 4, 5, 10, 13, 16, 17, 18, 22, 23, 24, 27 ], 
          [ 2, 3, 4, 8, 9, 10, 11, 14, 16, 18, 19, 21, 25 ], 
          [ 2, 3, 6, 9, 10, 11, 12, 13, 14, 15, 17, 24, 26 ], 
          [ 2, 4, 5, 7, 8, 9, 11, 12, 15, 19, 22, 24, 27 ], 
          [ 2, 5, 6, 7, 8, 11, 14, 16, 17, 21, 23, 26, 27 ], 
          [ 2, 6, 7, 10, 12, 15, 16, 17, 18, 19, 20, 25, 27 ], 
          [ 2, 6, 8, 9, 13, 15, 16, 20, 21, 22, 23, 24, 25 ], 
          [ 3, 4, 5, 6, 7, 9, 15, 17, 18, 21, 22, 25, 26 ], 
          [ 3, 4, 7, 11, 12, 13, 16, 20, 21, 24, 25, 26, 27 ], 
          [ 3, 5, 6, 8, 10, 14, 19, 20, 22, 24, 25, 26, 27 ], 
          [ 3, 7, 8, 12, 13, 14, 15, 16, 18, 19, 22, 23, 26 ], 
          [ 4, 5, 7, 8, 9, 10, 12, 13, 14, 17, 20, 23, 25 ], 
          [ 4, 6, 11, 12, 14, 17, 18, 19, 20, 21, 22, 23, 24 ], 
          [ 5, 9, 10, 11, 13, 15, 18, 19, 20, 21, 23, 26, 27 ] ] ] ]
</pre></div>

<p>We have constructed two <span class="SimpleMath">(27,13,6)</span> designs with blocks being difference sets in <span class="SimpleMath">ℤ_9⋊ ℤ_3</span>, which are not their developments. Here are the slice invariants of the difference and non-difference group 3-cubes constructed so far.</p>


<div class="example"><pre><span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dc:=List(l3,x-&gt;DifferenceCube(SmallGroup(v,x[1]),x[2],3));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gc:=List(l5,x-&gt;GroupCube(SmallGroup(v,x[1]),x[2],3));;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(dc,SliceInvariant);</span>
[ [ [ [ [ 1053, 27 ] ], 3 ] ], [ [ [ [ 1053, 27 ] ], 3 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(gc,SliceInvariant);</span>
[ [ [ [ [ 27, 27 ] ], 2 ], [ [ [ 1053, 27 ] ], 1 ] ], 
  [ [ [ [ 27, 27 ] ], 2 ], [ [ [ 1053, 27 ] ], 1 ] ] ]
</pre></div>

<p>More examples of difference and non-difference group cubes are available on our web page:</p>

<p><span class="URL"><a href="https://web.math.pmf.unizg.hr/~krcko/results/cubes.html">https://web.math.pmf.unizg.hr/~krcko/results/cubes.html</a></span></p>


<div class="chlinkprevnextbot">&nbsp;<a href="chap0.html">[Top of Book]</a>&nbsp;  <a href="chap0.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap0.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap2.html">[Next Chapter]</a>&nbsp;  </div>


<div class="chlinkbot"><span class="chlink1">Goto Chapter: </span><a href="chap0.html">Top</a>  <a href="chap1.html">1</a>  <a href="chap2.html">2</a>  <a href="chapBib.html">Bib</a>  <a href="chapInd.html">Ind</a>  </div>

<hr />
<p class="foot">generated by <a href="http://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p>
</body>
</html>
